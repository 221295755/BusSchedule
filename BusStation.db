-- Informations Systems Sql group Assignment

-- 1. Creation of tables

-- Bus Company Table creation
CREATE TABLE bus_company (
	bus_company_id INTEGER PRIMARY KEY,
	name VARCHAR(255) NOT NULL,
	street VARCHAR(255) NOT NULL,
	city VARCHAR(255) NOT NULL,
	zip_code INTEGER NOT NULL
);

-- Bus Table creation
CREATE TABLE bus (
	bus_id INTEGER PRIMARY KEY,
	bus_company_id INTEGER NOT NULL,
	capacity INTEGER,
	FOREIGN KEY (bus_company_id)
       REFERENCES bus_company (bus_company_id) 
);

-- bus station address creation
CREATE TABLE bus_station_address (
	bus_station_address_id INTEGER PRIMARY KEY,
	street VARCHAR(255) NOT NULL,
	city VARCHAR(255) NOT NULL,
	zip_code INTEGER NOT NULL
);

-- bus_station table creation
CREATE TABLE bus_station (
	bus_station_id INTEGER PRIMARY KEY,
	bus_station_address_id INTEGER NOT NULL,
	name VARCHAR(255) NOT NULL,
	FOREIGN KEY (bus_station_address_id)
       REFERENCES bus_station_address (bus_station_address_id) 
);

-- Trip Table creation
CREATE TABLE trip (
	trip_id INTEGER PRIMARY KEY,
	bus_station_id INTEGER NOT NULL,
	origin VARCHAR(255),
	destination VARCHAR(255),
	departure_time DATETIME,
	est_arrival_time DATETIME,
	FOREIGN KEY (bus_station_id)
       REFERENCES bus_station (bus_station_id) 
);

-- Bus trip Table creation
CREATE TABLE bus_trip (
	bus_trip_id INTEGER PRIMARY KEY,
	bus_id INTEGER NOT NULL,
	trip_id INTEGER NOT NULL,
	capacity INTEGER,
	FOREIGN KEY (bus_id)
       REFERENCES bus (bus_id),
	FOREIGN KEY (trip_id)
       REFERENCES trip (trip_id)  
);

-- passenger Table creation
CREATE TABLE passenger (
	passenger_id INTEGER PRIMARY KEY,
	first_name VARCHAR(255) NOT NULL,
	last_name VARCHAR(255) NOT NULL,
    date_of_birth DATE,
    gender CHAR(15),
	email_address VARCHAR(255),
	cellphone_number INTEGER,
	street VARCHAR(255),
	city VARCHAR(255) NOT NULL,
	zip_code INTEGER NOT NULL
);

-- booking Table creation
CREATE TABLE booking (
	booking_id INTEGER PRIMARY KEY,
	trip_id INTEGER NOT NULL,
	passenger_id INTEGER NOT NULL,
	seat INTEGER NOT NULL,
	price DECIMAL(10,5) NOT NULL,
	FOREIGN KEY (trip_id)
       REFERENCES trip (trip_id),
	FOREIGN KEY (passenger_id)
       REFERENCES passenger (passenger_id)
);


-- Addition by Anesu

CREATE TABLE Bus_Company
     (Bus_Company_ID int(2) NOT NULL,
     Name VARCHAR(25),
     Street varchar(25),
     City varchar(25),
     Zip_code int(4),
     primary key (Bus_Company_ID) 
     );
	 
	 CREATE TABLE Bus
     (Bus_ID int(3) NOT NULL,
     Bapacity int(2),
     Bus_Company_ID int(2),
     primary key (Bus_ID), foreign key (Bus_Company_ID) references Bus_Company (Bus_Company_ID) 
     );
	 
	 CREATE TABLE Trip
	(Trip_ID int(2) NOT NULL,
     Bus_ID int(3),
     Trip_Schedule_ID int(3),
	 primary key (Trip_ID),
	 foreign key(Bus_ID) references Bus(Bus_ID),
     foreign key(Trip_Schedule_ID) references Trip_Schedule(Trip_Schedule_ID));

	 

INSERT INTO Bus_Company VALUES
     (01,'Dube Transport','8 Flick Street','Cape Town',7490);
INSERT INTO Bus_Company VALUES
     (02,'Luxury Transport Company','3 Mayor Road','Durban',4011);
INSERT INTO Bus_Company VALUES
     (03,'Swift Transport','15 Baynes Rd','Pretoria',0011);
INSERT INTO Bus_Company VALUES
     (04,'Global Transport Company','4 Hammer Street','Johannesburg',2022);
INSERT INTO Bus_Company VALUES
     (05,'Ekhaya Transport','21 Maven Rd','Rustenburg',0308);

INSERT INTO Bus VALUES
     (001,50,01);
INSERT INTO Bus VALUES
     (002,60,02);
INSERT INTO Bus VALUES
     (003,50,03);
INSERT INTO Bus VALUES
     (004,60,04);
INSERT INTO Bus VALUES
     (005,50,05);


INSERT INTO Trip VALUES
     (01,001,001);
INSERT INTO Trip VALUES
     (02,002,002);
INSERT INTO Trip VALUES
     (03,003,003);
INSERT INTO Trip VALUES
     (04,004,004);
INSERT INTO Trip VALUES
     (05,005,005);
     
UPDATE Bus_Company
SET Name = 'Maybach Transport Company'
WHERE Bus_Company_ID = 03;
UPDATE Bus_Company
SET Name = 'City to City'
WHERE Bus_Company_ID = 04;
UPDATE Bus_Company
SET Name = 'Tusker Transport and Co'
WHERE Bus_Company_ID = 05;

UPDATE Bus
SET Capacity = 70
WHERE Bus_ID = 003;
UPDATE Bus
SET Capacity = 70
WHERE Bus_ID = 004;
UPDATE Bus
SET Capacity = 70
WHERE Bus_ID = 005;

UPDATE Trip
SET Bus_ID = 001
WHERE Trip_ID = 03;
UPDATE Trip
SET Bus_ID = 002
WHERE Trip_ID = 04;
UPDATE Trip
SET Bus_ID = 003
WHERE Trip_ID = 05;

CREATE VIEW Largest_Buses AS
SELECT Bus_ID, Capacity
FROM Bus
WHERE Capacity = 70;

CREATE VIEW Smallest_Buses AS
SELECT Bus_ID, Capacity
FROM Bus
WHERE Capacity = 50;


     
DELETE FROM Bus_Company WHERE Bus_Company_ID=03;
DELETE FROM Bus_Company WHERE Bus_Company_ID=04; 
DELETE FROM Bus_Company WHERE Bus_Company_ID=05; 

DELETE FROM Bus WHERE Bus_ID=003; 
DELETE FROM Bus WHERE Bus_ID=004; 
DELETE FROM Bus WHERE Bus_ID=005; 

DELETE FROM Trip WHERE Trip_ID=003; 
DELETE FROM Trip WHERE Trip_ID=004; 
DELETE FROM Trip WHERE Trip_ID=005; 



 






